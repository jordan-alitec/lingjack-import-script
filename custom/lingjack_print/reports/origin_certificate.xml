<odoo>
    <template id="report_invoice_certificate_origin_content">
        <t t-call="web.external_layout">
            <br/><br/>
            <div class="page">
                <div>
                    <strong>
                        <span t-field="o.invoice_date" t-options='{"widget": "date"}'/>
                    </strong>
                </div>
                <br/>
                <p>This Certificate is issued to:
                    <br/>
                    <p t-if="o.partner_id">
                        <span t-field="o.partner_id"
                              t-options="{'widget': 'contact', 'fields': ['name', 'address'], 'no_marker': true } "/>
                    </p>
                </p>

                <h2 style="text-align: center; color: #1f4e79; margin-top: 20px;">
                    CERTIFICATE OF ORIGIN
                </h2>

                <table class="table table-borderless"
                       style="width: 30%; margin-top: 20px; margin-bottom: 20px; border-collapse: collapse;">
                    <tr>
                        <td style="font-weight: bold; padding: 2px 4px;white-space: nowrap;">Certificate No</td>
                        <td style="padding: 2px 4px;">:</td>
                        <td style="padding: 2px 4px; white-space: nowrap;">
                            <span t-field="o.certificate_no"/>
                        </td>
                    </tr>
                    <tr>
                        <td style="font-weight: bold; padding: 2px 4px;white-space: nowrap;">Project</td>
                        <td style="padding: 2px 4px;">:</td>
                        <td style="padding: 2px 4px;">
                            <span t-field="o.project"/>
                        </td>
                    </tr>
                    <tr>
                        <td style="font-weight: bold; padding: 2px 4px;white-space: nowrap;">L/C No</td>
                        <td style="padding: 2px 4px;">:</td>
                        <td style="padding: 2px 4px;">
                            <span t-field="o.lc_no"/>
                        </td>
                    </tr>
                    <tr>
                        <td style="font-weight: bold; padding: 2px 4px;white-space: nowrap;">PO No</td>
                        <td style="padding: 2px 4px;">:</td>
                        <td style="padding: 2px 4px;">
                            <span t-field="o.ref"/>
                        </td>
                    </tr>
                </table>
                <div>
                    This is to certify that the items listed below is/are of the following origin :
                </div>
                <table class="table table-sm mt16" style="width: 100%; border: 1px solid">
                    <thead>
                        <tr style="background-color: #f0f0f0; color: #1f4e79;">
                            <th style="width: 5%;">S/N</th>
                            <th style="width: 20%;">Com</th>
                            <th style="width: 50%;">Description</th>
                            <th class="text-end" style="padding-right:5px;">Quantity</th>
                        </tr>
                    </thead>
                    <tbody>
                        <t t-set="sn" t-value="1"/>
                        <t t-foreach="o.invoice_line_ids" t-as="line">
                            <t t-if="line.quantity != 0 and line.product_id.product_tmpl_id.type == 'consu'">

                            <t t-if="not line.display_type or line.display_type == 'product'">
                                <t t-if="line.quantity != 0">
                                <tr>
                                    <td>
                                        <span t-esc="sn"/>
                                    </td>
                                    <td>
                                        <span t-field="line.product_id.default_code"/>
                                    </td>
                                    <td>
                                        <span t-field="line.name" style="white-space: pre-line;"/>
                                        <br/>
                                        <t t-if="line.product_id.country_of_origin">
                                            <span>Country of Origin :</span>
                                            <span t-field="line.product_id.country_of_origin"/>
                                            <br/>
                                        </t>
                                    </td>
                                    <td class="text-end" style="padding-right:5px;">
                                        <span t-field="line.quantity"/>
                                        <span t-field="line.product_uom_id"/>
                                    </td>
                                </tr>
                                    <t t-set="sn" t-value="sn + 1"/>
                                </t>
                            </t>
                            </t>
                        </t>
                    </tbody>
                </table>

                <p class="mt16">
                    <span t-field="o.remarks"/>
                </p>
                <br/><br/>
                <br/><br/>
                <br/><br/>

                <div style="width:30%; height:2px; background-color:black;"/>
                <div>Certified by</div>
                <p t-if="o.company_id">
                    <t t-esc="o.company_id.name or ''"/>
                </p>
            </div>
        </t>
    </template>

    <template id="report_invoice_certificate_origin">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="o">
                <t t-call="lingjack_print.report_invoice_certificate_origin_content"
                   t-lang="o._get_report_lang()"/>
            </t>
        </t>
    </template>

    <record id="action_report_invoice_certificate_origin" model="ir.actions.report">
        <field name="name">Certificate of Origin</field>
        <field name="model">account.move</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">lingjack_print.report_invoice_certificate_origin</field>
        <field name="report_file">lingjack_print.report_invoice_certificate_origin</field>
        <field name="print_report_name">'Certificate of Origin - %s' % (object.name)</field>
        <field name="binding_model_id" ref="account.model_account_move"/>
        <field name="binding_type">report</field>
    </record>
</odoo>